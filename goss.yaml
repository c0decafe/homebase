file:
  /home:
    exists: true
  /workspaces:
    exists: true
  /usr/local/share/init.sh:
    exists: true
    mode: "0755"
  /usr/local/share/ssh-init.sh:
    exists: true
    mode: "0755"
  /bin/sudo:
    exists: true
    owner: root
    group: root

user:
  vscode:
    exists: true
    uid: 1000
    gid: 1000

group:
  sudo:
    exists: true

command:
  init-runs:
    exec: bash -lc "sudo /usr/local/share/init.sh"
    exit-status: 0
  home-dir-ownership:
    exec: bash -lc "sudo /usr/local/share/init.sh && stat -c '%U:%G %a %n' /home /workspaces"
    stdout:
      - '^vscode:vscode 755 /home$'
      - '^vscode:vscode 755 /workspaces$'
  sudo-works:
    exec: bash -lc "sudo -n true"
    exit-status: 0
  ssh-init-runs:
    exec: bash -lc "sudo /usr/local/share/init.sh"
    exit-status: 0
  ssh-init-authorized-keys:
    exec: bash -lc "sudo /usr/local/share/init.sh && test -f /home/.ssh/authorized_keys"
    exit-status: 0
  sshd-listens-2222:
    exec: bash -lc "sudo /usr/local/share/init.sh && ss -lnpt | grep ':2222'"
    exit-status: 0
  sudo-setuid:
    exec: bash -lc "stat -c '%a' /bin/sudo"
    stdout:
      - '^4755$'
