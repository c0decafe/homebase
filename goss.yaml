file:
  /home:
    exists: true
  /workspaces:
    exists: true
  /usr/local/share/init.sh:
    exists: true
  /usr/local/share/ssh-init.sh:
    exists: true
  /bin/sudo:
    exists: true
    owner: root
    group: root

user:
  vscode:
    exists: true
    uid: 1000
    gid: 1000

group:
  sudo:
    exists: true

command:
  init-runs:
    exec: bash -lc "sudo /usr/local/share/init.sh"
    exit-status: 0
  init-script-exec:
    exec: bash -lc "test -x /usr/local/share/init.sh"
    exit-status: 0
  home-dir-ownership:
    exec: bash -lc "sudo /usr/local/share/init.sh >/dev/null && stat -c '%U:%G %a %n' /home /workspaces"
    exit-status: 0
    stdout:
      - '^vscode:vscode 755 /home$'
      - '^vscode:vscode 755 /workspaces$'
  sudo-works:
    exec: bash -lc "sudo -n true"
    exit-status: 0
  ssh-init-runs:
    exec: bash -lc "sudo /usr/local/share/ssh-init.sh"
    exit-status: 0
  ssh-init-script-exec:
    exec: bash -lc "test -x /usr/local/share/ssh-init.sh"
    exit-status: 0
  ssh-init-authorized-keys:
    exec: bash -lc "sudo test -f /home/.ssh/authorized_keys"
    exit-status: 0
  sshd-listens-2222:
    exec: bash -lc "sudo ss -lnpt | grep ':2222'"
    exit-status: 0
  sudo-symlink:
    exec: bash -lc "test \"$(readlink /bin/sudo)\" = 'doas'"
    exit-status: 0
  doas-setuid:
    exec: bash -lc "test \"$(stat -c '%a' /bin/doas)\" = '4755'"
    exit-status: 0
